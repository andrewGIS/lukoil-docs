FAQ
-----------------------------------------

.. _emptyСard:

Карточка пустая
**********************
Когда карточка поиска выглядит следующим образом (пустая)
    .. figure:: img/emptyCard.png
        :align: center
        :alt: Пустая форма
        :name: Пустая форма

        Пустая форма

на это есть несколько причин:

    * Вы перешли на **нулевую** запись таблицы, которая является пустой. Попробуйте кликнуть на кнопку *Следующая запись*. Аналогично вы могли "выйти" за пределы таблицы (следующая запись после последней). В этой ситуации попробуйте кликнуть *Предыдущая запись*
    * Выборка не содержит записей, удовлетворяющих условию
    * Для участка не создана запись в БД Земля

.. _sample-selection:

Примеры составления запросов
****************************
В данном разделе представлено несколько примеров по составлению запросов.

1. Например вы хотите выбрать участок c значением поля **ID 10817**. Открываем **Лукойл > Открыть карточку по запросу**

    .. figure:: img/sampleSelection/1_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Первый шаг

В открывшемся диалоге нажимаем **Добавить условие по базе** так, как эта колонка(**ID**) есть в БД Земля. Выбираем поле **ID** и нажимаем **Выбрать поле**.

    .. figure:: img/sampleSelection/1_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг
        :scale: 60 %

        Выбор поля **ID**

Попадаем в следующий диалог. Здесь нам необходимо просто занести 10817 в поле ввода.

    .. figure:: img/sampleSelection/1_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Занесенное значение атрибута **ID**

.. warning:: Обратите внимание на то, что в числовых целых полях нельзя ставить пробелы. Т.е. если ввести значение ``10 817`` вместо ``10817`` программа вылетит с ошибкой. Такой случай может возникнуть, если вы копируете значение из окна идентификации. 

Теперь нажмем кнопку **Добавить условие**. Текущий диалог закроется и мы вернемся в диалог запроса. 

    .. figure:: img/sampleSelection/1_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Диалог с сформированным выражением

Все готово для выполнения запроса. Можно нажать кнопку **Выполнить запрос**. Открывается результат выборки. 

    .. figure:: img/sampleSelection/1_5.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Результат выборки

Теперь можно работать с необходимой записью :ref:`приблизить к объекту <zoomToObject>`, :ref:`посмотреть земельное дело <openFolder>` и т.д. 

2. **Выбор по нескольким условиям в одном поле**. Теперь попробуем выбрать два участка со значениями **10817**, **10818**

    .. note:: Перед началом, повторите все операции из первого пункта 

Окно запроса должно выглядеть следующим образом.

    .. figure:: img/sampleSelection/2_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Состояние окна запроса на начало операции

Снова нажнем кнопку **Добавить условие по базе**. И выберем снова поле **ID**.

    .. figure:: img/sampleSelection/2_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг
        :scale: 60 %

        Выбор поля **ID**

Попадаем в знакомый диалог, где необходимо ввести значение. Вводим **10818** в поле. 

    .. figure:: img/sampleSelection/2_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Занесенное значение атрибута **ID**

Обратите внимание на то, что стал доступен оператор ``И``. Так как сейчас мы выбираем несколько значений **одного** поля нам необходим оператор ``ИЛИ``. Если мы выберем ``И`` то это значит, что нас интересует запись, у которой в поле **одновременно** содержится и значение 10817 и 10818 (а это невозможно). Выбираем в выпадающем списке оператор ``ИЛИ``. Теперь окошко выглядит следующим образом. 

    .. figure:: img/sampleSelection/2_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Занесенное значение атрибута **ID** с выбором необходимого оператора

Теперь можно добавить условие к основному запросу. Нажимаем кнопку **Добавить условие**. Теперь окно запроса выглядит следующим образом. 

    .. figure:: img/sampleSelection/2_5.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Диалог с сформированным выражением

Все готово для выполнения запроса. Можно нажать кнопку **Выполнить запрос**. Открывается результат выборки. Теперь в нашей выборке две записи, по которым мы можем перемещаться с помощью кнопок :ref:`Предыдущая/Следующая запись <navigation>`  

3. **Выбор по нескольким условиям в разных полях**. Теперь попробуем выбрать участки, которые находятся в Архангельской области и при этом их земельное дело имеет номер 121. 
Открываем **Лукойл > Открыть карточку по запросу**

    .. figure:: img/sampleSelection/1_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Первый шаг

В открывшемся диалоге нажимаем **Добавить условие по базе** так, как эта колонка(**ID**) есть в БД Земля. Выбираем поле **Номер_дела_в_архиве** и нажимаем **Выбрать поле**.

    .. figure:: img/sampleSelection/3_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг
        :scale: 60 %

        Выбор поля **Номер_дела_в_архиве**

Попадаем в следующий диалог. Теперь попробуем вставить значение с помощью кнопки **Получить значение из поля**. Нажав, попадаем в следующий диалог

    .. figure:: img/sampleSelection/3_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Выбор значения из уникального списка значений поля **Номер_дела_в_архиве**

Выберем **121** и нажмем **ОК**

    .. figure:: img/sampleSelection/3_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Выбранное значение

Теперь в поле значение появилось наше выбранное значение. 

    .. figure:: img/sampleSelection/3_5.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Записанное значение

Теперь можно добавить условие к основному запросу. Нажимаем кнопку **Добавить условие**. Теперь окно запроса выглядит следующим образом. 

    .. figure:: img/sampleSelection/3_6.png
        :align: center
        :alt: Шестой шаг
        :name: Шестой шаг

        Сформированное условие

Повторим аналогичные операции для поля **Субъект_федерации**. Снова нажимаем **Добавить условие по базе** так, как эта колонка(**Субъект_федерации**) есть в БД Земля. Выбираем поле **Субъект_федерации** и нажимаем **Выбрать поле**.

    .. figure:: img/sampleSelection/3_7.png
        :align: center
        :alt: Седьмой шаг
        :name: Седьмой шаг
        :scale: 60 %

        Выбор поля **Субъект_федерации**

Попадаем в следующий диалог. Аналогично вставляем значение с помощью кнопки **Получить значение из поля** и нажимаем **ОК**

    .. figure:: img/sampleSelection/3_8.png
        :align: center
        :alt: Восьмой шаг
        :name: Восьмой шаг

        Выбор значения из уникального списка значений поля **Субъект_федерации**

Теперь в поле значение появилось наше выбранное значение. 

    .. figure:: img/sampleSelection/3_9.png
        :align: center
        :alt: Девятый шаг
        :name: Девятый шаг

        Записанное значение

Обратите внимание на оператор ``И``. Так как нам нужны записи, которые удовлетворяют обоим условиям одновременно, а не по отдельности необходим именно этот оператор. Теперь можно добавить условие к основному запросу. Нажимаем кнопку **Добавить условие**. Теперь окно запроса выглядит следующим образом. 

    .. figure:: img/sampleSelection/3_10.png
        :align: center
        :alt: Десятый шаг
        :name: Десятый шаг

        Сформированное условие

Все готово для выполнения запроса. Можно нажать кнопку **Выполнить запрос**. Открываются результаты выборки, по которым мы можем перемещаться с помощью кнопок :ref:`Предыдущая/Следующая запись <navigation>`.  

4. **Выбор по базе и по адресу**. Теперь попробуем выбрать участки, по двум условиям. Нам нужен участок  с ID **10817**, а также участок, в описании которого имеется **СПК «Путь Ильича»**

    .. note:: Перед началом, повторите все операции из первого пункта 

Перед добавления условия по адресу окно запроса должно выглядеть как на рисунке. 

    .. figure:: img/sampleSelection/4_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Окно запроса

Теперь нажимаем кнопку **Добавить условие по адресу** и попадаем в диалог добавления условия по адресу.

    .. figure:: img/sampleSelection/4_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг

        Окно добавления условия по адресу

Выберем **Учитывать участковое лесничество**

    .. figure:: img/sampleSelection/4_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Активирование необходимого поля.

Нам стали доступны два дополнительных поля. Опять же можно ввести значение вручную (полностью или частично) или выбрать значение с помощью кнопки **Из поля**. В этом примере воспользуемся этой кнопкой. При нажатии открывается знакомый диалог с возможностью выбора значения. 

    .. figure:: img/sampleSelection/4_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Активирование необходимого поля.

Выберем значение **Мост Колва 5** и нажмем **ОК**
Наше значение добавилось в поле 

    .. figure:: img/sampleSelection/4_5.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Подставленное значение.

Теперь нажнем кнопку **Добавить к запросу**. И наше окошко главного запроса измениться. После этого можно нажимать кнопку **Выполнить запрос**.

    .. figure:: img/sampleSelection/4_6.png
        :align: center
        :alt: Шестой шаг
        :name: Шестой шаг

        Сформированный запрос.

Появляется карточка поиска с отобранными записями. Проверим результат запроса. Нажнем на первой записи в блоке управляющих кнопок **Посмотреть адрес**. Мы увидим адрес из графики, в котором также есть выбранное нами значение.

    .. figure:: img/sampleSelection/4_7.png
        :align: center
        :alt: Седьмой шаг
        :name: Седьмой шаг

        Проверка результатов. 


5. **Выбор по базе и по адресу**. Теперь попробуем выбрать участки, по трем условиям. Нам нужен участок  с ID **10817**, а также участок, в описании которого имеется **52** (подразумевается, что мы ищем 52 квартал), а также в участковом лесничестве есть (или описании, которое служит заменой участковому лесничеству) есть название **Колва**.

    .. note:: Перед началом, повторите все операции из первого пункта 

Перед добавлением условия по адресу окно запроса должно выглядеть как на рисунке. 

    .. figure:: img/sampleSelection/4_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Окно запроса

Нажимаем кнопку **Добавить условие по адресу**. И укажем, что мы будем использовать 2 поля *Квартал* и *Участковое лесничество*.

    .. figure:: img/sampleSelection/4_1_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг

        Выбор необходимых полей для запроса

Введем в первом поле **52**, а втором **олва**. Введем именно **олва**, чтобы включить написания (Колва и колва, например, если кто-то ошибся при вводе). Так как в программе для поиска значений используется оператор ``Like``, то можно вводить части выражений, которые вы хотите найти (или же выбрать из существующих значений). Так как сейчас нам надо, чтобы были найдены все записи, в котором соблюдается хотя бы одно из двух условий нам необходимо изменить оператор ``И`` на ``ИЛИ`` (выбрать в выпадающем списке предварительно нажать соответствующий квадратик). Теперь наше окно должно выглядеть следующим образом. а

    .. figure:: img/sampleSelection/4_1_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Введенные значения

Нажимаем кнопку **Добавить к запросу** и нажимаем **Выполнить запрос**. Открывается карточка с результатами поиска. Можно посмотреть какие результаты попали в выборку. Мы указывали, что в поле квартала должно было быть значение **52** (можно посмотреть с помощью кнопки **Посмотреть адрес**). Поэтому среди выборки есть объекты с такими значениями

    * Участок находится примерно в 5280 м от ориентира по направлению на юго-восток.
    * Участок находится примерно в 6520 м от ориентира по направлению на юго-восток.

Также в результат попали и объекты, у которых был разный вариант указания реки Колвы 

    * Мост Колва 5
    * мост Колва 5, через реку Колва

Таким образом можно осуществлять поиск как по фиксированным значениям, так и с помощью нечеткого поиска.




Как добавить новый участок
****************************
Описанная схема не является строгим алгоритмом. Вы можете изменять порядок действий или последовательность, если вы понимаете, что вы делаете. Представляю свое видение данного процесса. 
Представим, что нам необходимо добавить новый участок. Запускаем программу, и открываем для редактирования слой **Месторождения**. 

    .. figure:: img/sampleSelection/5_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Открытие слоя для редактирования. 

Теперь нарисуем новый тестовый участок. С помощью инструмента **Полигон**. 

    .. figure:: img/sampleSelection/5_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг

        Инструмент рисования. 

    .. figure:: img/sampleSelection/5_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Созданный полигон. 

Теперь нам необходимо внести соответствующий ID. В БД Земля ID присваиваются автоматически. Откроем БД Земля, чтобы узнать необходимый ID. 

    .. tip:: Можно перейти из программы MapInfo, через карточку поиска, а также напрямую открыть Microsoft Access.

    .. figure:: img/sampleSelection/5_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Форма для редактирования. 


.. |filter| Image:: img/sampleSelection/5_5.png
.. |noFilter| Image:: img/sampleSelection/5_6.png
.. |newRow| Image:: img/sampleSelection/5_7.png

Обратите, что сейчас для формы активирован фильтр |filter|. Для продолжения необходимо его отключить. Нажав на эту кнопку, можно сбросить фильтр (если необходимо). После переключения она становится вот такой -- |noFilter|. 
Добавим новую запись с помощью этой кнопки -- |newRow|. И для примера заполним несколько атрибутов. 

.. note:: Некоторые поля являются обязательными для заполнения. Без них новая запись не будет создана.

Для примера было заполнено несколько атрибутов. Теперь форма выглядит следующим образом. 

    .. figure:: img/sampleSelection/5_8.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Заполненная форма. 

Нам интересно значение, которое записано в поле **Номер участка** именно его мы должны скопировать и внести в поле **ID** графики. Закрываем Access.

.. note:: Если вы открывали Access из Проводника сохраните результаты перед выходом.

Вернемся в MapInfo и выберем инструмент **Новый список**. 

    .. figure:: img/sampleSelection/5_9.png
        :align: center
        :alt: Шестой шаг
        :name: Шестой шаг

        Расположение инструмента.

В появивившемся диалоге выберем **Selection** и нажмем **ОК**

    .. figure:: img/sampleSelection/5_10.png
        :align: center
        :alt: Седьмой шаг
        :name: Седьмой шаг

        Выбор таблицы.

.. note:: Созданный объект должен быть выделен. 

Внесите скопированное значение в поле **ID**, как показано на рисунке.  

    .. figure:: img/sampleSelection/5_11.png
        :align: center
        :alt: Восьмой шаг
        :name: Восьмой шаг

        Занесенное значение.   

Сохраните слой с помощью команды  **Сохранить таблицу**

    .. figure:: img/sampleSelection/5_12.png
        :align: center
        :alt: Девятый шаг
        :name: Девятый шаг

        Расположение инструмента.

Закончите редактирования слоя повторно нажав на кнопку начала редактирования слоя. Теперь попробуем перейти с созданного объекта на карточку поиска, через контекстное меню. Вы должны увидеть карточку с атрибутами, которые вы только что создали. 

    .. figure:: img/sampleSelection/5_13.png
        :align: center
        :alt: Десятый шаг
        :name: Десятый шаг

        Открытая карточка.

Таким образом можно устанавливать связь между записями БД Земля и графикой, создавать новые объекты, увязывать существующие записи и т.д. и т.п.

Как удалить запись или отредактировать контур объекта.
****************************
Для удаления какого-нибудь участка начните редактирование слоя

    .. figure:: img/sampleSelection/5_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Открытие слоя для редактирования. 

Выберите необходимый объект и нажмите клавишу **Delete** на клавиатуре или используйте контекстное меню. Если необходимо изменить контур объекта, выберете необходимый объект, затем нажмите кнопку **Форма** на панели.

    .. figure:: img/sampleSelection/6_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг

        Отображение вершин объекта. 

Измените необходимые узлы, добавьте новый с помощью клавиши **Добавить узел** и т.д. Выполните необходимые правки и переходите к следующему пункту.

    .. figure:: img/sampleSelection/6_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Добавление вершины к объекту. 

Сохраните изменения

.. tip:: Для упрощения работы отключите остальные слои в таблице содержания.

.. tip:: Если вы не хотите сохранять ваши изменения, вы может отказаться от их сохранения или использовать команду **Файл > Восстановить таблицу**.

Для удаления записи из БД Земля необходимо открыть ее (напрямую через Access или через MapInfo). И выбрать команду, **Удалить запись**

    .. figure:: img/sampleSelection/6_4.png
        :align: center
        :alt: Четверй шаг
        :name: Четвертый шаг

        Удаление записи из БД Земля. 

Проблемы с выбором по адресу
****************************
* Попробуйте убрать одинарные и двойные кавычки из описания местоположения

Выбор объектов по ID
****************************
* Попробуйте убрать одинарные и двойные кавычки из описания местоположения

.. _working_with_selection:

Работа со слоем выборки
**********************
Начиная с версии 0.18 результат последней выборки сохраняется в таблицу **Последняя_выборка_графика**. По умолчанию она не добавлена в текущее окно карты. Получить доступ к ней можно несколькими способами. 

1. Вариант первый:

    Открыть окно список открытых таблиц:

        .. figure:: img/query_table_access_v1.png
            :align: center
            :alt: Расположение команды Список открытых таблиц
            :name: Расположение команды Список открытых таблиц

    Работать с этой таблицей из данного окна:

    .. figure:: img/query_table_access_v1_2.png
            :align: center
            :alt: Расположение таблицы
            :name: Расположение таблицы
    
    Из этого окна ее можно перетаскивать в необходимое или новое окно, а также сохранять.

2. Второй вариант:

    Добавить полученный слой напрямую в окно карты. Для этого нажимаем плюс в списке слоев и в открывшемся списке выбираем слой **Последняя_выборка_графика** (обычно в конце) и нажимаем ОК для добавления слоя на текущую карту.

    Открыть окно список открытых таблиц:

        .. figure:: img/query_table_access_v2.png
            :align: center
            :alt: Расположение команды Список открытых таблиц
            :name: Расположение команды Список открытых таблиц
