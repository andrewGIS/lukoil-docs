FAQ
-----------------------------------------

.. _emptyСard:

Карточка пустая
**********************
Когда карточка поиска выглядит следующим образом (пустая)
    .. figure:: img/emptyCard.png
        :align: center
        :alt: Пустая форма
        :name: Пустая форма

        Пустая форма

на это есть несколько причин:

    * Вы перешли на **нулевую** запись таблицы, которая является пустой. Попробуйте кликнуть на кнопку *Следующая запись*. Аналогично вы могли "выйти" за пределы таблицы (следующая запись после последней). В этой ситуации попробуйте кликнуть *Предыдущая запись*
    * Выборка не содержит записей, удовлетворяющих условию
    * Для участка не создана запись в БД Земля

.. _sample-selection:

Примеры составления запросов
****************************
В данном разделе представлено нескольк примеров по составлению запросов.

1. Например вы хотите выбрать участок c значением поля **ID 10817**. Открываем **Лукойл > Открыть карточку по запросу**

    .. figure:: img/sampleSelection/1_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Первый шаг

В открывшемся диалоге нажимаем **Добавить условие по базе** так, как эта колонка(**ID**) есть в БД Земля. Выбираем поле **ID** и нажимаем **Выбрать поле**.

    .. figure:: img/sampleSelection/1_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг
        :scale: 60 %

        Выбор поля **ID**

Попадаем в следующий диалог. Здесь нам необходимо просто занести 10817 в поле ввода.

    .. figure:: img/sampleSelection/1_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Занесенное значение атрибута **ID**

.. warning:: Обратите внимание на то, что в числовых целых полях нельзя ставить пробелы. Т.е. если ввести значение ``10 817`` вместо ``10817`` программа вылетит с ошибкой. Такой случай может возникнуть, если вы копируете значение из окна идентификации. 

Теперь нажмем кнопку **Добавить условие**. Текущий диалог закроется и мы вернемся в диалог запроса. 

    .. figure:: img/sampleSelection/1_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Диалог с сформированным выражением

Все готово для выполнения запроса. Можно нажать кнопку **Выполнить запрос**. Открывается результат выборки. 

    .. figure:: img/sampleSelection/1_5.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Результат выборки

Теперь можно работать с необходимой записью :ref:`приблизить к объекту <zoomToObject>`, :ref:`посмотреть земельное дело <openFolder>` и т.д. 

2. **Выбор по нескольким условиям в одном поле**. Теперь попробуем выбрать два участка со значениями **10817**, **10818**

    .. note:: Перед началом, повторите все операции из первого пункта 

Окно запроса должно выглядет следующим образом.

    .. figure:: img/sampleSelection/2_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Состояние окна запроса на начало операции

Снова нажнем кнопку **Добавить условие по базе**. И выберем снова поле **ID**.

    .. figure:: img/sampleSelection/2_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг
        :scale: 60 %

        Выбор поля **ID**

Попадаем в знакомый диалог, где необходимо ввести значение. Вводим **10818** в поле. 

    .. figure:: img/sampleSelection/2_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Занесенное значение атрибута **ID**

Обратите внимание на то, что стал доступен оператор ``И``. Так как сейчас мы выбираем несколько значений **одного** поля нам необходим оператор ``ИЛИ``. Если мы выберем ``И`` то это значит, что нас интересует запись, у которой в поле **одновременно** содержится и значение 10817 и 10818 (а это невозможно). Выбираем в выпадающем списке оператор ``ИЛИ``. Теперь окошко выглядит следующим образом. 

    .. figure:: img/sampleSelection/2_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Занесенное значение атрибута **ID** с выбором необходимого оператора

Теперь можно добавить условие к основному запросу. Нажимаем кнопку **Добавить условие**. Теперь окно запроса выглядит следующим образом. 

    .. figure:: img/sampleSelection/2_5.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Диалог с сформированным выражением

Все готово для выполнения запроса. Можно нажать кнопку **Выполнить запрос**. Открывается результат выборки. Теперь в нашей выборке две записи, по которым мы можем перемещаться с помощью кнопок :ref:`Предыдущая/Следующая запись <navigation>`  

3. **Выбор по нескольким условиям в разных полях**. Теперь попробуем выбрать участки, которые находятся в Архангельской области и при этом их земельное дело имеет номер 121. 
Открываем **Лукойл > Открыть карточку по запросу**

    .. figure:: img/sampleSelection/1_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Первый шаг

В открывшемся диалоге нажимаем **Добавить условие по базе** так, как эта колонка(**ID**) есть в БД Земля. Выбираем поле **Номер_дела_в_архиве** и нажимаем **Выбрать поле**.

    .. figure:: img/sampleSelection/3_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг
        :scale: 60 %

        Выбор поля **Номер_дела_в_архиве**

Попадаем в следующий диалог. Теперь попробуем вставить значение с помощью кнопки **Получить значение из поля**. Нажав, попадаем в следующий диалог

    .. figure:: img/sampleSelection/3_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Выбор значения из уникального списка значений поля **Номер_дела_в_архиве**

Выберем **121** и нажмем **ОК**

    .. figure:: img/sampleSelection/3_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Выбранное значение

Теперь в поле значение появилось наше выбранное значение. 

    .. figure:: img/sampleSelection/3_5.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Записанное значение

Теперь можно добавить условие к основному запросу. Нажимаем кнопку **Добавить условие**. Теперь окно запроса выглядит следующим образом. 

    .. figure:: img/sampleSelection/3_6.png
        :align: center
        :alt: Шестой шаг
        :name: Шестой шаг

        Сформированное условие

Повторим аналогичные операции для поля **Субъект_федерации**. Снова нажимаем **Добавить условие по базе** так, как эта колонка(**Субъект_федерации**) есть в БД Земля. Выбираем поле **Субъект_федерации** и нажимаем **Выбрать поле**.

    .. figure:: img/sampleSelection/3_7.png
        :align: center
        :alt: Сельмой шаг
        :name: Седьмой шаг
        :scale: 60 %

        Выбор поля **Субъект_федерации**

Попадаем в следующий диалог. Аналогично вставляем значение с помощью кнопки **Получить значение из поля** и нажимаем **ОК**

    .. figure:: img/sampleSelection/3_8.png
        :align: center
        :alt: Восьмой шаг
        :name: Восьмой шаг

        Выбор значения из уникального списка значений поля **Субъект_федерации**

Теперь в поле значение появилось наше выбранное значение. 

    .. figure:: img/sampleSelection/3_9.png
        :align: center
        :alt: Девятый шаг
        :name: Девятый шаг

        Записанное значение

Обратите внимание на оператор ``И``. Так как нам нужны записи, которые удовлетворяют обоим условиям одновременно, а не по отдельности необходим именно этот оператор.Теперь можно добавить условие к основному запросу. Нажимаем кнопку **Добавить условие**. Теперь окно запроса выглядит следующим образом. 

    .. figure:: img/sampleSelection/3_10.png
        :align: center
        :alt: Десятый шаг
        :name: Десятый шаг

        Сформированное условие

Все готово для выполнения запроса. Можно нажать кнопку **Выполнить запрос**. Открываются результаты выборки, по которым мы можем перемещаться с помощью кнопок :ref:`Предыдущая/Следующая запись <navigation>`.  

4. **Выбор по базе и по адресу**. Теперь попробуем выбрать участки, которые находятся в Архангельской области и при этом их земельное дело имеет номер 121. 

Как добавить новый участок
****************************
Описанная схема не является строгим алгоритмом. Вы можете изменять порядок действий или последовательность, если вы понимаете, что вы делаете. Представляю свое видение данного процесса. 
Представим, что нам необходимо добавить новый участок. Отркываем программу, и открываем для редактирования слой **Месторождения**. 

    .. figure:: img/sampleSelection/5_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Открытие слоя для редактирования. 

Теперь нарисуем новый тестовый участок. С помощью инструмента **Полигон**. 

    .. figure:: img/sampleSelection/5_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг

        Инструмент рисования. 

    .. figure:: img/sampleSelection/5_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Созданный полигон. 

Теперь нам необходимо внести соотвествующий ID. В БД Земля ID присваиваются автоматически. Откроем БД Земля, чтобы узнать необходимый ID. 

    .. tip:: Можно перейти из программы MapInfo, через карточку поиска, а также напрямую открыть Microsoft Access.

    .. figure:: img/sampleSelection/5_4.png
        :align: center
        :alt: Четвертый шаг
        :name: Четвертый шаг

        Форма для редактирования. 


.. |filter| Image:: img/sampleSelection/5_5.png
.. |noFilter| Image:: img/sampleSelection/5_6.png
.. |newRow| Image:: img/sampleSelection/5_7.png

Обратите, что сейчас для формы активирован фильтр |filter|. Для продолжения необходимо его отключить. Нажав на эту кнопку, можно сбросить фильтр (если необходимо). После переключения она становится вот такой -- |noFilter|. 
Добавим новую запись с помощью этой кнопки -- |newRow|. И для примера заполним несколько атрибутов. 

.. note:: Некоторые поля является обязательными для заполнения. Без них новая запись не будет создана.

Для примера было заполнено несколько атрибутов. Теперь форма выглядит следующим образом. 

    .. figure:: img/sampleSelection/5_8.png
        :align: center
        :alt: Пятый шаг
        :name: Пятый шаг

        Заполненная форма. 

Нам интересно значение, которое записано в поле **Номер участка** именно его мы должны скопировать и внести в поле **ID** графики. Закрываем Access.

.. note:: Если вы открывали Access из Проводника сохраните результаты перед выходом.

Вернемся в MapInfo и выберем инструмент **Новый список**. 

    .. figure:: img/sampleSelection/5_9.png
        :align: center
        :alt: Шестой шаг
        :name: Шестой шаг

        Расположение инструмента.

В появивишемся диалоге выберем **Selection** и нажмем **ОК**

    .. figure:: img/sampleSelection/5_10.png
        :align: center
        :alt: Седьмой шаг
        :name: Седьмой шаг

        Выбор таблицы.

.. note:: Созданный объект должен быть выделен. 

Внесите скопированное значение в поле **ID**, как показано на рисунке.  

    .. figure:: img/sampleSelection/5_11.png
        :align: center
        :alt: Восьмой шаг
        :name: Восьмой шаг

        Занесенное значение.   

Сохраните слой с помощью команды  **Сохранить таблицу**

    .. figure:: img/sampleSelection/5_12.png
        :align: center
        :alt: Девятый шаг
        :name: Девятый шаг

        Расположение инструмента.

Закончите редактирования слоя повторно нажав на кнопку начала редактирования слоя. Теперь попробуем перейти с созданного объекта на карточку поиска, через контекстное меню. Вы должны увидеть карточку с атрибутами, которые вы только что создали. 

    .. figure:: img/sampleSelection/5_13.png
        :align: center
        :alt: Десятый шаг
        :name: Десятый шаг

        Открытая карточка.

Таким образом можно устанавливать связь между записями БД Земля и графикой, создавать новые объекты, увязывать существующие записи и т.д. и т.п.

Как удалить запись или отредактировать контур объекта.
****************************
Для удаления какого-нибудь участка начните редактирование слоя

    .. figure:: img/sampleSelection/5_1.png
        :align: center
        :alt: Первый шаг
        :name: Первый шаг

        Открытие слоя для редактирования. 

Выберите необходимый объект и нажмите клавишу **Delete** на клавиатуре, или используйте контекстное меню. Если необходимо изменить контур объекта, выбирете необходимый объект, затем нажмите кнопку **Форма** на панели.

    .. figure:: img/sampleSelection/6_2.png
        :align: center
        :alt: Второй шаг
        :name: Второй шаг

        Отображение вершин объекта. 

Измените необходимые узлы, добавьте новый с помью клавиши **Добавить узел** и т.д. Выполните необходимые правки и переходите к следующему пункту.

    .. figure:: img/sampleSelection/6_3.png
        :align: center
        :alt: Третий шаг
        :name: Третий шаг

        Добавление вершины к объекту. 

 Сохраните изменения

.. tip:: Для упрощения работы отключите остальные слои в таблице содержания.

.. tip:: Если вы не хотите сохранять ваши изменения, вы может отказаться от их сохранения или использовать команду **Файл > Восстановить таблицу**.

Для удаления записи из БД Земля необходимо открыть ее (напрямую через Access или через MapInfo). И выбрать команду, **Удалить запись**

    .. figure:: img/sampleSelection/6_4.png
        :align: center
        :alt: Четверй шаг
        :name: Четвертый шаг

        Удаление записи из БД Земля. 
